
lctl get_param version
lnetctl global show
lnetctl peer show -v

stripe_size
The number of bytes in each stripe. This much data is written to each stripe before starting 
to write in the next stripe. The default is 1048576.

stripe_count
The number of OSTs that each file is striped across. 
Any number of OSTs can be striped across, from a single OST (the default is one) to all available OSTs.

Striping can increase the rate that data files can be read or written. 
However, reliability decreases as the number of stripes increases. 
Damage to a single OST can cause loss of data in many files.

When configuring striping for Lustre file systems, We recommends:
•Striping files across one to four OSTs
•Setting stripe count value greater than 2 (this gives good performance for many types of jobs; 
for larger file systems, a larger stripe width may improve performance)
•Choosing the default stripe size of 1MB (1048576 bytes)



lfs setstripe -s 4M /mnt/lustre/new_file
lfs getstripe /mnt/lustre/new_file

lfs setstripe -c -1 /mnt/lustre/full_stripe
(stripe over all OSTs)

lfs getstripe /mnt/lustre/full_stripe

create a file on specific OST
lfs setstripe --stripe-count 1 --index 0 file1 

https://www.nics.tennessee.edu/computing-resources/file-systems/lustre-striping-guide

========================================================


Failover functionality such as node monitoring, failure detection, and resource fencing must be provided by external
HA software, such as PowerMan or the open source Corosync and Pacemaker packages provided by Linux
operating system vendors. Corosync provides support for detecting failures, and Pacemaker provides the
actions to take once a failure has been detected.



Identifying a Missing OST...

1. Generate a list of devices and determine the OST's device number. Run:
$ lctl dl
The lctl dl command output lists the device name and number, along with the device UUID and the
number of references on the device.
2. Deactivate the OST (on the OSS at the MDS). Run:
$ lctl --device lustre_device_number deactivate
The OST device number or device name is generated by the lctl dl command.
The deactivate command prevents clients from creating new objects on the specified OST,
although you can still access the OST for reading.
Note
If the OST later becomes available it needs to be reactivated, run:
# lctl --device lustre_device_number activate
3. Determine all files that are striped over the missing OST, run:
# lfs find -O {OST_UUID} /mountpoint
This returns a simple list of filenames from the affected file system.
4. If necessary, you can read the valid parts of a striped file, run:
# dd if=filename of=new_filename bs=4k conv=sync,noerror
5. You can delete these files with the unlink command.
# unlink filename {filename ...}


list all open file in lustre
lctl get_param mdt.*.exports.*.open_files

check the location of these files
lfs fid2path /myth [0x200003ab4:0x435:0x0] [0x20001e863:0x1c1:0x0] 
:lfs fid2path: cannot find '[0x200003ab4:0x435:0x0]'

Note
When you run the unlink command, it may return an error that the file could not be found,
but the file on the MDS has been permanently removed.


lst list_group clients --all